<div class="home hidden" aria-hidden="true">
  <div class="form_container">

    <!-- Signup Form (modal) -->
    <form id="signupForm" class="signup_form" aria-hidden="true">
      <div class="auth-card auth-card-white">
        <button class="form_close" aria-label="Close auth dialog">×</button>
        <h3 class="auth-heading">Create Account</h3>
        <p class="auth-sub">Join PROJECT UNITE to manage your inventory and attendance efficiently</p>
        {% csrf_token %}
        <div class="form-row"><input id="signup_first_name" name="first_name" class="auth-input" placeholder="First Name" required></div>
        <div class="form-row"><input id="signup_last_name" name="last_name" class="auth-input" placeholder="Last Name" required></div>
        <div class="form-row"><input id="signup_email" name="email" type="email" class="auth-input" placeholder="Email" required></div>
        <div class="form-row"><input id="signup_student_number" name="student_number" class="auth-input" placeholder="Student Number (7 digits)" required pattern="\d{7}" title="Must be exactly 7 digits"></div>
        <div class="form-row">
            <div class="input_box">
                <input id="signup_password" name="password" type="password" class="auth-input" placeholder="Password" required>
                <i class="fas fa-eye-slash toggle-password" tabindex="0" role="button" aria-label="Show password" aria-describedby="signup_password_help"></i>
            </div>
        </div>
        <div class="form-row">
            <div class="input_box">
                <input id="confirm_password" name="confirm_password" type="password" class="auth-input" placeholder="Confirm Password" required>
                <i class="fas fa-eye-slash toggle-password" tabindex="0" role="button" aria-label="Show password" aria-describedby="confirm_password_help"></i>
            </div>
        </div>
        <button id="signup" class="cta-button auth-cta" type="submit">Create Account</button>
        <p class="auth-switch">Already have an account? <a href="#" id="goToLogin" class="auth-link">Log in</a></p>
      </div>
    </form>

    <!-- Login Form (modal) -->
    <div id="loginForm" class="login_form" aria-hidden="false">
      <div class="figma-login-card modal-login-card">
        <!-- Left Panel - Blue with form -->
        <div class="figma-login-left modal-login-left">
          <button class="form_close login_close" aria-label="Close auth dialog">×</button>
          <div class="figma-login-welcome">welcome</div>
          <h1 class="figma-login-title">PROJECT UNITE</h1>
          <p class="figma-login-subtitle">INEFFICIENT OFFICER ATTENDANCE LOGGING AND INVENTORY TRACKING</p>

          <form class="figma-login-form modal-login-form">
            {% csrf_token %}
            <div class="figma-input-wrapper"><input type="text" id="login_identifier" name="identifier" placeholder="username" class="figma-form-input auth-input" required></div>
            <div class="figma-input-wrapper">
                <div class="input_box">
                    <input type="password" id="login_password" name="password" placeholder="password" class="figma-form-input auth-input" required>
                    <i class="fas fa-eye-slash toggle-password" tabindex="0" role="button" aria-label="Show password" aria-describedby="login_password_help"></i>
                </div>
            </div>
            <div class="figma-forgot-link"><a href="#" id="goToResetFromLogin" class="auth-link">Forgot your password?</a></div>
            <button type="submit" class="figma-login-button auth-cta">Login</button>
          </form>

          <div class="figma-signup-prompt">Don't have an account? <a href="#" id="goToSignup" class="figma-signup-link">Sign up here</a></div>
        </div>

        <!-- Right Panel - White with logo -->
        <div class="figma-login-right modal-login-right">
          <div class="figma-logo-container">
            <img src="https://api.builder.io/api/v1/image/assets/TEMP/a65df8bbc0c314444292b21f3727e85bdea1974e?width=1426" alt="PROJECT UNITE Logo" class="figma-logo-image">
          </div>
        </div>
      </div>
    </div>

  </div>
</div>


  <!-- Password Reset Form (modal) -->
  <form id="passwordResetForm" class="password_reset_form" aria-hidden="true" action="{% url 'password_reset' %}" method="post">
    <div class="auth-card auth-card-small">
      <button class="form_close" aria-label="Close auth dialog">×</button>
      <h3 class="auth-heading">Reset password</h3>
      <p class="auth-sub">Enter your account email to receive a reset link</p>
      {% csrf_token %}
      <div class="form-row"><input id="reset_email" name="email" type="email" class="auth-input" placeholder="Email" required autocomplete="email"></div>
      <button type="submit" class="cta-button auth-cta">Send reset link</button>
      <p class="auth-switch"><a href="#" id="backToLoginFromReset" class="auth-link">Back to login</a></p>
    </div>
  </form>

<script>
// Public helper to show a specific auth modal view
function showAuthModal(viewId) {
  const homeModal = document.querySelector('.home');
  if (homeModal) homeModal.classList.remove('hidden');

  // If the password reset form lives outside the modal, move it into the modal container
  if (viewId === 'passwordResetForm') {
    const resetEl = document.getElementById('passwordResetForm');
    const container = document.querySelector('.form_container');
    if (resetEl && container && resetEl.parentElement !== container) {
      container.appendChild(resetEl);
    }
  }

  const viewIds = ['signupForm', 'loginForm', 'passwordResetForm'];
  viewIds.forEach(id => {
    const el = document.getElementById(id);
    if (!el) return;
    el.setAttribute('aria-hidden', id === viewId ? 'false' : 'true');
  });

  const active = document.getElementById(viewId);
  if (active) {
    const input = active.querySelector('input');
    if (input) input.focus();
  }
}
window.showAuthModal = showAuthModal;

document.addEventListener('DOMContentLoaded', function() {
  const homeModal = document.querySelector('.home');
  const closeButtons = document.querySelectorAll('.form_close');
  closeButtons.forEach(btn => btn.addEventListener('click', () => {
    if (homeModal) homeModal.classList.add('hidden');
  }));



  // Open/close helpers for links inside modal
  const goToSignup = document.getElementById('goToSignup');
  const goToLogin = document.getElementById('goToLogin');
  const backToLoginFromReset = document.getElementById('backToLoginFromReset');
  const goToResetFromLogin = document.getElementById('goToResetFromLogin');
  if (goToSignup) {
    goToSignup.addEventListener('click', (e) => {
      e.preventDefault();
      showAuthModal('signupForm');
    });
  }
  if (goToLogin) {
    goToLogin.addEventListener('click', (e) => {
      e.preventDefault();
      showAuthModal('loginForm');
    });
  }
  if (goToResetFromLogin) {
    goToResetFromLogin.addEventListener('click', (e) => {
      e.preventDefault();
      showAuthModal('passwordResetForm');
    });
  }
  if (backToLoginFromReset) {
    backToLoginFromReset.addEventListener('click', (e) => {
      e.preventDefault();
      showAuthModal('loginForm');
    });
  }
});
</script>
